(this.webpackJsonpblap=this.webpackJsonpblap||[]).push([[0],{47:function(e,t,a){},50:function(e,t,a){},53:function(e,t,a){e.exports=a(95)},80:function(e,t,a){},82:function(e,t,a){},85:function(e,t,a){},86:function(e,t,a){},94:function(e,t,a){},95:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),s=a(22),r=a.n(s),l=a(4),i=a(5),c=a(8),u=a(7),p=a(6),d=a(18),m=a(52),h={msg:{},status:null,id:null},b=a(1),g={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:null,user:null,loadingSubmit:!1,followingList:null},f={title:null,content:null,author:null,createdAt:null,isLoading:null,foundPost:null,deletedPost:!1},E={isLoading:null,list:[],noFollowing:null,userNotFound:null,last:null},O={error:null,creatingPost:!1},v=Object(d.c)({error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return{msg:t.payload.msg,status:t.payload.status,id:t.payload.id};case"CLEAR_ERRORS":return{msg:{},status:null,id:null};default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case"USER_LOADED":return Object(b.a)(Object(b.a)({},e),{},{isAuthenticated:!0,isLoading:!1,user:t.payload});case"LOADING_SUBMIT":return Object(b.a)(Object(b.a)({},e),{},{loadingSubmit:!0});case"LOGIN_SUCCESS":case"SIGNUP_SUCCESS":return localStorage.setItem("token",t.payload.token),Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isAuthenticated:!0,isLoading:!1,loadingSubmit:!1});case"LOGOUT_SUCCESS":case"DELETE_USER":return localStorage.removeItem("token"),window.location.reload(!0),Object(b.a)(Object(b.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1});case"LOAD_FOLLOWING":return Object(b.a)(Object(b.a)({},e),{},{followingList:t.payload.followingList});case"FOLLOW":case"UNFOLLOW":return Object(b.a)(Object(b.a)({},e),{},{followingList:t.payload.newFollowing});case"AUTH_ERROR":case"LOGIN_FAIL":case"SIGNUP_FAIL":return localStorage.removeItem("token"),Object(b.a)(Object(b.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1,loadingSubmit:!1});default:return e}},post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_POST":return Object(b.a)(Object(b.a)({},t.payload),{},{foundPost:!0,isLoading:!1});case"GET_POST_ERROR":case"NO_POST_ID":return Object(b.a)(Object(b.a)({},e),{},{foundPost:!1,isLoading:!1});case"POST_LOADING":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case"DELETE_POST":return Object(b.a)(Object(b.a)({},f),{},{deletedPost:!0});default:return e}},postList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_POSTS":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0,last:!0});case"ALL_POSTS":return Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isLoading:!1,noFollowing:null});case"USER_POSTS":return Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isLoading:!1,noFollowing:null,userNotFound:!1});case"USER_NOT_FOUND":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1,userNotFound:!0});case"FOLLOWING_POSTS":return Object(b.a)({isLoading:!1},t.payload);default:return e}},createPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATING_POST":return Object(b.a)(Object(b.a)({},e),{},{creatingPost:!0,error:null});case"POST_SUCCESS":case"EDIT_POST":return window.location="/blap/#/post?id="+t.payload.newPostId,Object(b.a)(Object(b.a)({},e),{},{creatingPost:!1});case"POST_TOO_SHORT":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"Your post must have at least 2 blocks"},creatingPost:!1});case"POST_NO_TITLE":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"The first block of your post must be the title (H1)"},creatingPost:!1});case"CREATE_POST_ERROR":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"An unknown error occured"},creatingPost:!1});case"DIFF_TITLE":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:'You cannot edit the title of "'+t.payload.oldTitle+'"'},creatingPost:!1});default:return e}}}),y=[m.a],w=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d.d,N=Object(d.e)(v,{},w(d.a.apply(void 0,y))),S=a(3),j=a(10),L=(a(62),a(11)),k=a.n(L),P=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"GET_ERRORS",payload:{msg:e,status:t,id:a}}},T=function(){return{type:"CLEAR_ERRORS"}},_=function(){return function(e,t){k.a.get("/auth/following",R(t)).then((function(t){e({type:"LOAD_FOLLOWING",payload:{followingList:t.data.following}})})).catch((function(t){e(P(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},A=function(e){return function(t,a){var n=JSON.stringify({user:e});k.a.patch("/auth/unfollow",n,R(a)).then((function(e){t({type:"UNFOLLOW",payload:{newFollowing:e.data.following}})})).catch((function(e){t(P(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})}))}},R=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},F=(a(80),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return o.a.createElement("nav",{className:"navbar navbar-dark bg-dark navbar-expand-lg static-top"},o.a.createElement(S.b,{to:"/",className:"navbar-brand"},"blap"),o.a.createElement("div",{className:"collapse navbar-collapse"},o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:this.props.isAuthenticated?"/all":"/",className:"nav-link"},"All")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:this.props.isAuthenticated?"/following":"/login",className:"nav-link"},"Following")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:this.props.isAuthenticated?"/create":"/login",className:"nav-link"},"Create Post"))),o.a.createElement("ul",{className:"right-nav navbar-nav ml-md-auto"},this.props.isLoading?null:this.props.isAuthenticated?o.a.createElement("div",null,o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:"/user/"+this.props.user.username,className:"nav-link"},this.props.user.username)),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:"/settings",className:"nav-link"},"Settings")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:"/",className:"nav-link",onClick:this.props.logout},"Log out"))):o.a.createElement("div",null,o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:"/signup",className:"nav-link"},"Sign up")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(S.b,{to:"/login",className:"nav-link"},"Log in"))))))}}]),a}(o.a.Component)),C=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,isLoading:e.auth.isLoading,user:e.auth.user}}),{logout:function(){return{type:"LOGOUT_SUCCESS"}}})(F),I=a(20),U=a(9),D=(a(47),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",msg:null},n.onChange=n.onChange.bind(Object(U.a)(n)),n.onSubmit=n.onSubmit.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.error,n=t.isAuthenticated;a!==e.error&&("SIGNUP_FAIL"===a.id?this.setState({msg:a.msg.msg}):this.setState({msg:null})),n&&(window.location="/blap/#/")}},{key:"onChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(I.a)({},a,n))}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,a={username:t.username,password:t.password};this.props.signup(a)}},{key:"render",value:function(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h1",null,"Sign up"),o.a.createElement("form",{onSubmit:this.onSubmit,className:"form-signin"},o.a.createElement("input",{name:"username",type:"text",value:this.state.username,onChange:this.onChange,placeholder:"Username",autoFocus:!0,className:"form-control"}),o.a.createElement("input",{name:"password",type:"password",value:this.state.password,onChange:this.onChange,placeholder:"Password",className:"form-control"}),this.state.msg?o.a.createElement("div",{className:"alert alert-danger"},this.state.msg):null,o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",disabled:this.props.loadingSubmit},this.props.loadingSubmit?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Submit")),o.a.createElement("p",null,"Already have an account? ",o.a.createElement(S.b,{to:"/login"},"Log in")))}}]),a}(o.a.Component)),x=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error,loadingSubmit:e.auth.loadingSubmit}}),{signup:function(e){var t=e.username,a=e.password;return function(e){e({type:"LOADING_SUBMIT"});var n=JSON.stringify({username:t,password:a});k.a.post("/users/signup",n,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"SIGNUP_SUCCESS",payload:t.data})})).catch((function(t){e(P(t.response.data,t.response.status,"SIGNUP_FAIL")),e({type:"SIGNUP_FAIL"})}))}},clearErrors:T})(D),G=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={username:"",password:"",msg:null},n.onChange=n.onChange.bind(Object(U.a)(n)),n.onSubmit=n.onSubmit.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(e){var t=this.props,a=t.error,n=t.isAuthenticated;a!==e.error&&("LOGIN_FAIL"===a.id?this.setState({msg:a.msg.msg}):this.setState({msg:null})),n&&(window.location="/blap/#/")}},{key:"onChange",value:function(e){var t=e.target,a=t.name,n=t.value;this.setState(Object(I.a)({},a,n))}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,a={username:t.username,password:t.password};this.props.login(a)}},{key:"render",value:function(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h1",null,"Log in"),o.a.createElement("form",{onSubmit:this.onSubmit,className:"form-signin"},o.a.createElement("input",{name:"username",type:"text",value:this.state.username,onChange:this.onChange,placeholder:"Username",autoFocus:!0,className:"form-control"}),o.a.createElement("input",{name:"password",type:"password",value:this.state.password,onChange:this.onChange,placeholder:"Password",className:"form-control"}),this.state.msg?o.a.createElement("div",{className:"alert alert-danger"},this.state.msg):null,o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",disabled:this.props.loadingSubmit},this.props.loadingSubmit?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Submit")),o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(S.b,{to:"/signup"},"Sign up")))}}]),a}(o.a.Component),W=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error,loadingSubmit:e.auth.loadingSubmit}}),{login:function(e){var t=e.username,a=e.password;return function(e){e({type:"LOADING_SUBMIT"});var n=JSON.stringify({username:t,password:a});k.a.post("/auth/login",n,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"LOGIN_SUCCESS",payload:t.data})})).catch((function(t){e(P(t.response.data,t.response.status,"LOGIN_FAIL")),e({type:"LOGIN_FAIL"})}))}},clearErrors:T})(G),M=(a(82),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={deleteWarning:!1,showFollowing:!1},n.deleteWarning=n.deleteWarning.bind(Object(U.a)(n)),n.deleteUser=n.deleteUser.bind(Object(U.a)(n)),n.openFollowing=n.openFollowing.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.loadFollowingList()}},{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/blap/#/")}},{key:"deleteWarning",value:function(){this.setState({deleteWarning:!0})}},{key:"deleteUser",value:function(){this.props.deleteUser()}},{key:"openFollowing",value:function(){this.setState((function(e){return{showFollowing:!e.showFollowing}}))}},{key:"unfollow",value:function(e){this.props.unfollow(e)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("h1",null,"Settings"),o.a.createElement("br",null),o.a.createElement("div",{className:"row following-header"},o.a.createElement("h3",{className:"col"},"Following"),o.a.createElement("button",{className:"col following-btn btn btn-sm btn-secondary btn-block",onClick:this.openFollowing},this.state.showFollowing?"Hide":"Show")),this.state.showFollowing?o.a.createElement("ul",{className:"list-group"},this.props.followingList.length>0?this.props.followingList.slice().reverse().map((function(t){return o.a.createElement("li",{className:"list-group-item",key:t},o.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:function(){return e.unfollow(t)}},"X"),o.a.createElement(S.b,{to:"/user/"+t,className:"following-username text-dark"},t))})):o.a.createElement("li",{className:"list-group-item"},"You are not following any users")):o.a.createElement("ul",{className:"list-group"},o.a.createElement("li",{className:"list-group-item"},". . .")),o.a.createElement("br",null),o.a.createElement("h3",null,"Delete Account"),this.state.deleteWarning?o.a.createElement("div",null,o.a.createElement("p",null,"Are you sure? Your account will be deleted permanently."),o.a.createElement("button",{className:"delete-acc-btn btn btn-danger btn-block",onClick:this.deleteUser},"Yes, I'm sure")):o.a.createElement("button",{className:"delete-acc-btn btn btn-danger btn-block",onClick:this.deleteWarning},"Delete"))}}]),a}(o.a.Component)),H=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,followingList:e.auth.followingList}}),{deleteUser:function(){return function(e,t){k.a.delete("/auth/delete",R(t)).then((function(t){e({type:"DELETE_USER",payload:t.data})})).catch((function(t){e(P(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},loadFollowingList:_,unfollow:A})(M),J=a(17),B=a.n(J),Y=(a(85),function(e){return function(t){t({type:"POST_LOADING"}),k.a.get("/posts/id/"+e.toString()).then((function(e){t({type:"GET_POST",payload:e.data})})).catch((function(){t({type:"GET_POST_ERROR"})}))}}),Q=function(){return{type:"NO_POST_ID"}},X=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},z=function(e){var t="";switch(e.type){case"paragraph":return t="<p>"+e.data.text+"</p>",V(t);case"header":return t="<h"+e.data.level+">",t+=e.data.text,t+="</h"+e.data.level+">",V(t);case"simpleImage":var a="",n={};return e.data.withBorder&&(a+="border "),e.data.stretched?a+="w-100 ":n={maxWidth:"650px",margin:"auto",display:"block"},o.a.createElement("div",null,o.a.createElement("img",{src:e.data.url,className:a,style:n,alt:e.data.caption}),o.a.createElement("p",{className:"text-center text-muted"},e.data.caption));case"delimiter":return o.a.createElement("h3",{className:"text-center"},"* * *");case"list":return"ordered"===e.data.style?o.a.createElement("ol",null,e.data.items.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("p",null,e))}))):o.a.createElement("ul",null,e.data.items.map((function(e,t){return o.a.createElement("li",{key:t},o.a.createElement("p",null,e))})));default:return o.a.createElement("div",null)}},V=function(e){return o.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}})},$=function(e){return o.a.createElement("div",null,e.blocks.map((function(e,t){return o.a.createElement(z,{key:t,type:e.type,data:e.data})})))},q=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).deletePost=n.deletePost.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.id=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).id,this.id?this.props.getPost(this.id):this.props.noPostId()}},{key:"deletePost",value:function(){this.props.deletePost(this.id)}},{key:"render",value:function(){return this.props.isLoading?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):this.props.deletedPost?o.a.createElement("div",{className:"blog-post"},o.a.createElement("p",{className:"text-center"},"Post deleted")):this.props.foundPost?o.a.createElement("div",{className:"blog-post"},o.a.createElement("div",{className:"text-muted"},o.a.createElement(S.b,{to:"/user/"+this.props.author,className:"text-muted author"},this.props.author)," ",o.a.createElement("p",{style:{display:"inline"},className:"small"},this.props.createdAt.substring(0,10))),o.a.createElement($,{blocks:this.props.content.blocks}),o.a.createElement("br",null),this.props.user&&this.props.user.username===this.props.author?o.a.createElement("div",{className:"row post-btns"},o.a.createElement(S.b,{to:"/edit?id="+this.id,className:"edit-btn btn btn-sm btn-primary btn-block"},"Edit"),o.a.createElement("button",{onClick:this.deletePost,className:"delete-btn btn btn-sm btn-danger btn-block"},"Delete")):null):o.a.createElement("div",{className:"blog-post"},o.a.createElement("p",{className:"text-center"},"Couldn't find post"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry"))}}]),a}(o.a.Component),K=Object(p.b)((function(e){return{title:e.post.title,content:e.post.content,author:e.post.username,createdAt:e.post.createdAt,isLoading:e.post.isLoading,deletedPost:e.post.deletedPost,foundPost:e.post.foundPost,user:e.auth.user}}),{getPost:Y,deletePost:function(e){return function(t,a){e?k.a.delete("/posts/id/"+e.toString(),X(a)).then((function(e){t({type:"DELETE_POST",payload:e.data})})).catch((function(e){t(P(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})})):window.location="/blap/#/"}},noPostId:Q})(q);a(86);function Z(e){return o.a.createElement("div",null,o.a.createElement("div",{className:"card border-dark"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h2",{className:"card-title"},o.a.createElement(S.b,{to:e.data.postDestination,className:"text-dark stretched-link"},e.data.title)),o.a.createElement("div",{className:"card-subtitle text-muted"},o.a.createElement(S.b,{to:e.data.userDestination,className:"text-muted author"},e.data.author)," ",o.a.createElement("p",{style:{display:"inline"},className:"small date"},e.data.date)))),o.a.createElement("br",null))}var ee=a(31),te=function(e,t,a){return function(n){n({type:"LOADING_POSTS"});var o=JSON.stringify({before:t,after:a});k.a.post("/users/"+e+"/posts",o,{headers:{"Content-type":"application/json"}}).then((function(e){var t=Object(ee.a)(e.data.posts);n({type:"USER_POSTS",payload:{list:t,last:e.data.last}})})).catch((function(){n({type:"USER_NOT_FOUND"})}))}},ae=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},ne=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={page:null,before:null,after:null},n.updateList=n.updateList.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0});this.updateList(e)}},{key:"componentDidUpdate",value:function(){var e=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0});e.page===this.state.page&&e.before===this.state.before&&e.after===this.state.after||this.updateList(e)}},{key:"updateList",value:function(e){var t=this;this.setState({page:e.page,before:e.before,after:e.after},(function(){switch(t.props.listType){case"all":t.props.allPosts(t.state.before,t.state.after);break;case"following":t.props.followingPosts(t.state.before,t.state.after);break;case"user":t.props.userPosts(t.props.username,t.state.before,t.state.after);break;default:t.props.allPosts(t.before,t.after)}}))}},{key:"render",value:function(){return this.props.isLoading?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):0===this.props.list.length?o.a.createElement("h3",{className:"text-center"},"There's nothing here!"):o.a.createElement("div",null,this.props.list.map((function(e){return o.a.createElement(Z,{key:e._id,data:{title:e.title,author:e.username,date:e.createdAt.substring(0,10),postDestination:"/post?id="+e._id,userDestination:"/user/"+e.username}})})),o.a.createElement("nav",null,o.a.createElement("ul",{className:"pagination"},this.state.page>"1"&&o.a.createElement("li",{className:"page-item"},o.a.createElement(S.b,{className:"page-link border-dark text-dark",to:"/"+this.props.listType+("user"===this.props.listType?"/"+this.props.username:"")+"?page="+(parseInt(this.state.page?this.state.page:"1")-1)+"&after="+(this.props.list.length>0?this.props.list[0].createdAt:"")},"Previous")),!this.props.last&&o.a.createElement("li",{className:"page-item"},o.a.createElement(S.b,{className:"page-link border-dark text-dark",to:"/"+this.props.listType+("user"===this.props.listType?"/"+this.props.username:"")+"?page="+(parseInt(this.state.page?this.state.page:"1")+1)+"&before="+this.props.list[this.props.list.length-1].createdAt},"Next")))))}}]),a}(o.a.Component),oe=Object(p.b)((function(e){return{isLoading:e.postList.isLoading,list:e.postList.list,last:e.postList.last}}),{allPosts:function(e,t){return function(a){a({type:"LOADING_POSTS"});var n=JSON.stringify({before:e,after:t});k.a.post("/posts/all",n,{headers:{"Content-type":"application/json"}}).then((function(e){var t=Object(ee.a)(e.data.posts);a({type:"ALL_POSTS",payload:{list:t,last:e.data.last}})})).catch()}},followingPosts:function(e,t){return function(a,n){a({type:"LOADING_POSTS"});var o=JSON.stringify({before:e,after:t});k.a.post("/posts/following",o,ae(n)).then((function(e){var t=Object(ee.a)(e.data.posts);a({type:"FOLLOWING_POSTS",payload:{list:t,noFollowing:e.data.noFollowing,last:e.data.last}})})).catch((function(e){a(P(e.response.data,e.response.status)),a({type:"AUTH_ERROR"})}))}},userPosts:te})(ne),se=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):o.a.createElement("div",null,o.a.createElement("h1",null,this.props.isAuthenticated?this.props.noFollowing&&!this.props.isLoading?"Discover":"Following":"All Posts"),o.a.createElement("br",null),o.a.createElement(oe,{listType:this.props.isAuthenticated&&!this.props.noFollowing?"following":"all",location:this.props.location}))}}]),a}(o.a.Component),re=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(se),le=a(24),ie=a.n(le),ce=a(25),ue=a.n(ce),pe=a(26),de=a.n(pe),me=a(27),he=a.n(me),be=a(28),ge=a.n(be),fe=a(29),Ee=a.n(fe),Oe=a(30),ve=a.n(Oe),ye=(a(50),function(){return{type:"POST_TOO_SHORT"}}),we=function(){return{type:"POST_NO_TITLE"}},Ne=function(e){var t=e().auth.token,a={headers:{"Content-type":"application/json"}};return t&&(a.headers["x-auth-token"]=t),a},Se=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={editorIsReady:!1},n.handlePost=n.handlePost.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.editor=new ie.a({holder:"editorjs",placeholder:"New Post",autofocus:!0,tools:{header:ue.a,simpleImage:de.a,delimiter:he.a,list:ge.a,underline:Ee.a,inlineCode:ve.a},onReady:function(){e.setState({editorIsReady:!0})},data:{time:0,blocks:[{type:"header",data:{text:"New Post",level:1}}],version:"2.18.0"}})}},{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/blap/#/login")}},{key:"handlePost",value:function(){var e=this;this.editor.save().then((function(t){var a=t.blocks;a.length<2?e.props.postTooShort():"header"!==a[0].type||1!==a[0].data.level?e.props.postNoTitle():e.props.postSuccess(t)})).catch((function(e){console.log("Saving failed: "+e)}))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{id:"editorjs"}),this.state.editorIsReady?o.a.createElement("div",null,this.props.error?o.a.createElement("div",{className:"alert alert-danger text-center"},this.props.error.msg):null,o.a.createElement("button",{className:"post-button btn btn-lg btn-success btn-block",onClick:this.handlePost},this.props.creatingPost?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Post")):null)}}]),a}(o.a.Component),je=Object(p.b)((function(e){return{error:e.createPost.error,creatingPost:e.createPost.creatingPost,isAuthenticated:e.auth.isAuthenticated}}),{postSuccess:function(e){return function(t,a){t({type:"CREATING_POST"});var n={title:e.blocks[0].data.text,content:e},o=JSON.stringify(n);k.a.post("/posts/create",o,Ne(a)).then((function(e){t({type:"POST_SUCCESS",payload:{newPostId:e.data.post._id}})})).catch((function(){t({type:"CREATE_POST_ERROR"})}))}},postTooShort:ye,postNoTitle:we})(Se),Le=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={editorIsReady:!1},n.handlePost=n.handlePost.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.id=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).id,this.id?this.props.getPost(this.id):this.props.noPostId()}},{key:"componentDidUpdate",value:function(){var e=this;!1===this.props.isAuthenticated&&(window.location="/blap/#/login"),!this.editor&&this.props.foundPost&&(this.editor=new ie.a({holder:"editorjs",placeholder:"Click here to start writing!",tools:{header:ue.a,simpleImage:de.a,delimiter:he.a,list:ge.a,underline:Ee.a,inlineCode:ve.a},onReady:function(){e.setState({editorIsReady:!0})},data:this.props.content}))}},{key:"handlePost",value:function(){var e=this;this.editor.save().then((function(t){var a=t.blocks;a.length<2?e.props.postTooShort():"header"!==a[0].type||1!==a[0].data.level?e.props.postNoTitle():e.props.title!==a[0].data.text?e.props.diffTitle(e.props.title):e.props.editPost(e.id,t)})).catch((function(e){console.log("Saving failed: "+e)}))}},{key:"render",value:function(){return!1===this.props.foundPost?o.a.createElement("div",null,o.a.createElement("p",{className:"text-center"},"Couldn't find post"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry")):this.props.isAuthenticated&&this.props.author!==this.props.user.username?o.a.createElement("div",{className:"alert alert-danger text-center"},"You are not authorized to edit this post."):o.a.createElement("div",null,o.a.createElement("div",{id:"editorjs"}),this.state.editorIsReady?o.a.createElement("div",null,this.props.error?o.a.createElement("div",{className:"alert alert-danger text-center"},this.props.error.msg):null,o.a.createElement("button",{className:"post-button btn btn-lg btn-success btn-block",onClick:this.handlePost},this.props.creatingPost?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Save")):null)}}]),a}(o.a.Component),ke=Object(p.b)((function(e){return{error:e.createPost.error,creatingPost:e.createPost.creatingPost,isAuthenticated:e.auth.isAuthenticated,user:e.auth.user,title:e.post.title,content:e.post.content,author:e.post.username,foundPost:e.post.foundPost}}),{editPost:function(e,t){return function(a,n){a({type:"CREATING_POST"});var o={content:t},s=JSON.stringify(o);k.a.patch("/posts/id/"+e,s,Ne(n)).then((function(){a({type:"EDIT_POST",payload:{newPostId:e}})})).catch((function(){a({type:"CREATE_POST_ERROR"})}))}},postTooShort:ye,postNoTitle:we,diffTitle:function(e){return{type:"DIFF_TITLE",payload:{oldTitle:e}}},getPost:Y,noPostId:Q})(Le),Pe=(a(94),function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(l.a)(this,a),(n=t.call(this,e)).state={isFollowing:null},n.toggleFollow=n.toggleFollow.bind(Object(U.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.loadFollowingList()}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.followingList&&null===this.state.isFollowing){var t=null;this.props.followingList.forEach((function(a,n){a===e.props.match.params.username&&(t=!0,e.setState({isFollowing:!0}))})),null===t&&this.setState({isFollowing:!1})}}},{key:"toggleFollow",value:function(){this.state.isFollowing?this.props.unfollow(this.props.match.params.username):this.props.follow(this.props.match.params.username),this.setState((function(e){return{isFollowing:!e.isFollowing}}))}},{key:"render",value:function(){return null===this.props.userNotFound?(this.props.userPosts(this.props.match.params.username),o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"}))):this.props.userNotFound?o.a.createElement("div",null,o.a.createElement("p",{className:"text-center"},"Couldn't find user"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry")):o.a.createElement("div",null,o.a.createElement("div",{className:"row"},o.a.createElement("h1",{className:"col col-md-auto"},this.props.match.params.username),null!==this.state.isFollowing&&this.props.self&&this.props.self.username!==this.props.match.params.username?this.state.isFollowing?o.a.createElement("button",{className:"follow-btn col btn btn-sm btn-secondary btn-block",onClick:this.toggleFollow},"Unfollow"):o.a.createElement("button",{className:"follow-btn col btn btn-sm btn-primary btn-block",onClick:this.toggleFollow},"Follow"):null),o.a.createElement("br",null),o.a.createElement(oe,{listType:"user",username:this.props.match.params.username,location:this.props.location}))}}]),a}(o.a.Component)),Te=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,userNotFound:e.postList.userNotFound,followingList:e.auth.followingList,self:e.auth.user}}),{loadFollowingList:_,userPosts:te,follow:function(e){return function(t,a){var n=JSON.stringify({user:e});k.a.patch("/auth/follow",n,R(a)).then((function(e){t({type:"FOLLOW",payload:{newFollowing:e.data.following}})})).catch((function(e){t(P(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})}))}},unfollow:A})(Pe),_e=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=B.a.parse(this.props.location,{ignoreQueryPrefix:!0});this.page=e.page?e.page:"null"}},{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&"none"===this.page&&(window.location="/blap/#/")}},{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):o.a.createElement("div",null,o.a.createElement("h1",null,"All Posts"),o.a.createElement("br",null),o.a.createElement(oe,{listType:"all",location:this.props.location}))}}]),a}(o.a.Component),Ae=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(_e),Re=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/blap/#/login")}},{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):this.props.noFollowing?o.a.createElement("div",null,o.a.createElement("h1",null,"Following"),o.a.createElement("h3",{className:"text-center"},"There's nothing here!")):o.a.createElement("div",null,o.a.createElement("h1",null,"Following"),o.a.createElement("br",null),o.a.createElement(oe,{listType:"following",location:this.props.location}))}}]),a}(o.a.Component),Fe=Object(p.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(Re),Ce=function(e){Object(c.a)(a,e);var t=Object(u.a)(a);function a(){return Object(l.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){N.dispatch((function(e,t){e({type:"USER_LOADING"}),k.a.get("/auth/user",R(t)).then((function(t){return e({type:"USER_LOADED",payload:t.data})})).catch((function(t){t.response&&e(P(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}))}},{key:"render",value:function(){return o.a.createElement(p.a,{store:N},o.a.createElement(S.a,null,o.a.createElement("div",null,o.a.createElement(C,null),o.a.createElement("br",null),o.a.createElement("div",{className:"container-fluid"},o.a.createElement(j.a,{path:"/",component:re,exact:!0}),o.a.createElement(j.a,{path:"/all",component:Ae}),o.a.createElement(j.a,{path:"/following",component:Fe}),o.a.createElement(j.a,{path:"/signup",component:x}),o.a.createElement(j.a,{path:"/login",component:W}),o.a.createElement(j.a,{path:"/settings",component:H}),o.a.createElement(j.a,{path:"/post",component:K}),o.a.createElement(j.a,{path:"/create",component:je}),o.a.createElement(j.a,{path:"/edit",component:ke}),o.a.createElement(j.a,{path:"/user/:username",component:Te})))))}}]),a}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));k.a.defaults.baseURL="https://blap-api.herokuapp.com/api",r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.f97200f2.chunk.js.map