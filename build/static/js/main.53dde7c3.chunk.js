(this.webpackJsonpblap=this.webpackJsonpblap||[]).push([[0],{47:function(e,t,n){},50:function(e,t,n){},53:function(e,t,n){e.exports=n(95)},80:function(e,t,n){},82:function(e,t,n){},85:function(e,t,n){},86:function(e,t,n){},94:function(e,t,n){},95:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),s=n(21),r=n.n(s),l=n(3),i=n(4),c=n(7),u=n(6),d=n(5),p=n(17),m=n(52),h={msg:{},status:null,id:null},b=n(1),g={token:localStorage.getItem("token"),isAuthenticated:null,isLoading:null,user:null,loadingSubmit:!1,followingList:null},f={title:null,content:null,author:null,createdAt:null,isLoading:null,foundPost:null,deletedPost:!1},E={isLoading:null,list:[],noFollowing:null,userNotFound:null},O={error:null,creatingPost:!1,newPostId:null},v=Object(p.c)({error:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return{msg:t.payload.msg,status:t.payload.status,id:t.payload.id};case"CLEAR_ERRORS":return{msg:{},status:null,id:null};default:return e}},auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:g,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_LOADING":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case"USER_LOADED":return Object(b.a)(Object(b.a)({},e),{},{isAuthenticated:!0,isLoading:!1,user:t.payload});case"LOADING_SUBMIT":return Object(b.a)(Object(b.a)({},e),{},{loadingSubmit:!0});case"LOGIN_SUCCESS":case"SIGNUP_SUCCESS":return localStorage.setItem("token",t.payload.token),Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isAuthenticated:!0,isLoading:!1,loadingSubmit:!1});case"LOGOUT_SUCCESS":case"DELETE_USER":return localStorage.removeItem("token"),window.location.reload(!0),Object(b.a)(Object(b.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1});case"LOAD_FOLLOWING":return Object(b.a)(Object(b.a)({},e),{},{followingList:t.payload.followingList});case"FOLLOW":case"UNFOLLOW":return Object(b.a)(Object(b.a)({},e),{},{followingList:t.payload.newFollowing});case"AUTH_ERROR":case"LOGIN_FAIL":case"SIGNUP_FAIL":return localStorage.removeItem("token"),Object(b.a)(Object(b.a)({},e),{},{token:null,user:null,isAuthenticated:!1,isLoading:!1,loadingSubmit:!1});default:return e}},post:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:f,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_POST":return Object(b.a)(Object(b.a)({},t.payload),{},{foundPost:!0,isLoading:!1});case"GET_POST_ERROR":case"NO_POST_ID":return Object(b.a)(Object(b.a)({},e),{},{foundPost:!1,isLoading:!1});case"POST_LOADING":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case"DELETE_POST":return Object(b.a)(Object(b.a)({},f),{},{deletedPost:!0});default:return e}},postList:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOADING_POSTS":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!0});case"ALL_POSTS":return Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isLoading:!1,noFollowing:null});case"USER_POSTS":return Object(b.a)(Object(b.a)(Object(b.a)({},e),t.payload),{},{isLoading:!1,noFollowing:null,userNotFound:!1});case"USER_NOT_FOUND":return Object(b.a)(Object(b.a)({},e),{},{isLoading:!1,userNotFound:!0});case"FOLLOWING_POSTS":return Object(b.a)({isLoading:!1},t.payload);default:return e}},createPost:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CREATING_POST":return Object(b.a)(Object(b.a)({},e),{},{creatingPost:!0,error:null});case"POST_SUCCESS":case"EDIT_POST":return Object(b.a)(Object(b.a)({},e),{},{creatingPost:!1,newPostId:t.payload.newPostId});case"POST_TOO_SHORT":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"Your post must have at least 2 blocks"},creatingPost:!1});case"POST_NO_TITLE":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"The first block of your post must be the title (H1)"},creatingPost:!1});case"CREATE_POST_ERROR":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:"An unknown error occured"},creatingPost:!1});case"DIFF_TITLE":return Object(b.a)(Object(b.a)({},e),{},{error:{msg:'You cannot edit the title of "'+t.payload.oldTitle+'"'},creatingPost:!1});default:return e}}}),y=[m.a],w=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||p.d,S=Object(p.e)(v,{},w(p.a.apply(void 0,y))),N=n(8),j=n(9),P=(n(62),n(11)),L=n.n(P),k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:"GET_ERRORS",payload:{msg:e,status:t,id:n}}},T=function(){return{type:"CLEAR_ERRORS"}},A=function(){return function(e,t){L.a.get("/auth/following",I(t)).then((function(t){e({type:"LOAD_FOLLOWING",payload:{followingList:t.data.following}})})).catch((function(t){e(k(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},_=function(e){return function(t,n){var a=JSON.stringify({user:e});L.a.patch("/auth/unfollow",a,I(n)).then((function(e){t({type:"UNFOLLOW",payload:{newFollowing:e.data.following}})})).catch((function(e){t(k(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})}))}},I=function(e){var t=e().auth.token,n={headers:{"Content-type":"application/json"}};return t&&(n.headers["x-auth-token"]=t),n},R=(n(80),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return o.a.createElement("nav",{className:"navbar navbar-dark bg-dark navbar-expand-lg static-top"},o.a.createElement(N.b,{to:"/",className:"navbar-brand"},"blap"),o.a.createElement("div",{className:"collapse navbar-collapse"},o.a.createElement("ul",{className:"navbar-nav"},o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:this.props.isAuthenticated?"/all":"/",className:"nav-link"},"All")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:this.props.isAuthenticated?"/following":"/login",className:"nav-link"},"Following")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:this.props.isAuthenticated?"/create":"/login",className:"nav-link"},"Create Post"))),o.a.createElement("ul",{className:"right-nav navbar-nav ml-md-auto"},this.props.isLoading?null:this.props.isAuthenticated?o.a.createElement("div",null,o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:"/user/"+this.props.user.username,className:"nav-link"},this.props.user.username)),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:"/settings",className:"nav-link"},"Settings")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:"/",className:"nav-link",onClick:this.props.logout},"Log out"))):o.a.createElement("div",null,o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:"/signup",className:"nav-link"},"Sign up")),o.a.createElement("li",{className:"navbar-item"},o.a.createElement(N.b,{to:"/login",className:"nav-link"},"Log in"))))))}}]),n}(o.a.Component)),C=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,isLoading:e.auth.isLoading,user:e.auth.user}}),{logout:function(){return{type:"LOGOUT_SUCCESS"}}})(R),F=n(19),U=n(10),D=(n(47),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",msg:null},a.onChange=a.onChange.bind(Object(U.a)(a)),a.onSubmit=a.onSubmit.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.error,a=t.isAuthenticated;n!==e.error&&("SIGNUP_FAIL"===n.id?this.setState({msg:n.msg.msg}):this.setState({msg:null})),a&&(window.location="/")}},{key:"onChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(F.a)({},n,a))}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,n={username:t.username,password:t.password};this.props.signup(n)}},{key:"render",value:function(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h1",null,"Sign up"),o.a.createElement("form",{onSubmit:this.onSubmit,className:"form-signin"},o.a.createElement("input",{name:"username",type:"text",value:this.state.username,onChange:this.onChange,placeholder:"Username",autoFocus:!0,className:"form-control"}),o.a.createElement("input",{name:"password",type:"password",value:this.state.password,onChange:this.onChange,placeholder:"Password",className:"form-control"}),this.state.msg?o.a.createElement("div",{className:"alert alert-danger"},this.state.msg):null,o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",disabled:this.props.loadingSubmit},this.props.loadingSubmit?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Submit")),o.a.createElement("p",null,"Already have an account? ",o.a.createElement(N.b,{to:"/login"},"Log in")))}}]),n}(o.a.Component)),x=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error,loadingSubmit:e.auth.loadingSubmit}}),{signup:function(e){var t=e.username,n=e.password;return function(e){e({type:"LOADING_SUBMIT"});var a=JSON.stringify({username:t,password:n});L.a.post("/users/signup",a,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"SIGNUP_SUCCESS",payload:t.data})})).catch((function(t){e(k(t.response.data,t.response.status,"SIGNUP_FAIL")),e({type:"SIGNUP_FAIL"})}))}},clearErrors:T})(D),G=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={username:"",password:"",msg:null},a.onChange=a.onChange.bind(Object(U.a)(a)),a.onSubmit=a.onSubmit.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.error,a=t.isAuthenticated;n!==e.error&&("LOGIN_FAIL"===n.id?this.setState({msg:n.msg.msg}):this.setState({msg:null})),a&&(window.location="/")}},{key:"onChange",value:function(e){var t=e.target,n=t.name,a=t.value;this.setState(Object(F.a)({},n,a))}},{key:"onSubmit",value:function(e){e.preventDefault();var t=this.state,n={username:t.username,password:t.password};this.props.login(n)}},{key:"render",value:function(){return o.a.createElement("div",{className:"text-center"},o.a.createElement("h1",null,"Log in"),o.a.createElement("form",{onSubmit:this.onSubmit,className:"form-signin"},o.a.createElement("input",{name:"username",type:"text",value:this.state.username,onChange:this.onChange,placeholder:"Username",autoFocus:!0,className:"form-control"}),o.a.createElement("input",{name:"password",type:"password",value:this.state.password,onChange:this.onChange,placeholder:"Password",className:"form-control"}),this.state.msg?o.a.createElement("div",{className:"alert alert-danger"},this.state.msg):null,o.a.createElement("button",{className:"btn btn-lg btn-primary btn-block",disabled:this.props.loadingSubmit},this.props.loadingSubmit?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Submit")),o.a.createElement("p",null,"Don't have an account? ",o.a.createElement(N.b,{to:"/signup"},"Sign up")))}}]),n}(o.a.Component),W=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,error:e.error,loadingSubmit:e.auth.loadingSubmit}}),{login:function(e){var t=e.username,n=e.password;return function(e){e({type:"LOADING_SUBMIT"});var a=JSON.stringify({username:t,password:n});L.a.post("/auth/login",a,{headers:{"Content-type":"application/json"}}).then((function(t){return e({type:"LOGIN_SUCCESS",payload:t.data})})).catch((function(t){e(k(t.response.data,t.response.status,"LOGIN_FAIL")),e({type:"LOGIN_FAIL"})}))}},clearErrors:T})(G),H=(n(82),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={deleteWarning:!1,showFollowing:!1},a.deleteWarning=a.deleteWarning.bind(Object(U.a)(a)),a.deleteUser=a.deleteUser.bind(Object(U.a)(a)),a.openFollowing=a.openFollowing.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.loadFollowingList()}},{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/")}},{key:"deleteWarning",value:function(){this.setState({deleteWarning:!0})}},{key:"deleteUser",value:function(){this.props.deleteUser()}},{key:"openFollowing",value:function(){this.setState((function(e){return{showFollowing:!e.showFollowing}}))}},{key:"unfollow",value:function(e){this.props.unfollow(e)}},{key:"render",value:function(){var e=this;return o.a.createElement("div",null,o.a.createElement("h1",null,"Settings"),o.a.createElement("br",null),o.a.createElement("div",{className:"row following-header"},o.a.createElement("h3",{className:"col"},"Following"),o.a.createElement("button",{className:"col following-btn btn btn-sm btn-secondary btn-block",onClick:this.openFollowing},this.state.showFollowing?"Hide":"Show")),this.state.showFollowing?o.a.createElement("ul",{className:"list-group"},this.props.followingList.length>0?this.props.followingList.slice().reverse().map((function(t){return o.a.createElement("li",{className:"list-group-item",key:t},o.a.createElement("button",{className:"btn btn-sm btn-danger",onClick:function(){return e.unfollow(t)}},"X"),o.a.createElement(N.b,{to:"/user/"+t,className:"following-username text-dark"},t))})):o.a.createElement("li",{className:"list-group-item"},"You are not following any users")):o.a.createElement("ul",{className:"list-group"},o.a.createElement("li",{className:"list-group-item"},". . .")),o.a.createElement("br",null),o.a.createElement("h3",null,"Delete Account"),this.state.deleteWarning?o.a.createElement("div",null,o.a.createElement("p",null,"Are you sure? Your account will be deleted permanently."),o.a.createElement("button",{className:"delete-acc-btn btn btn-danger btn-block",onClick:this.deleteUser},"Yes, I'm sure")):o.a.createElement("button",{className:"delete-acc-btn btn btn-danger btn-block",onClick:this.deleteWarning},"Delete"))}}]),n}(o.a.Component)),M=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,followingList:e.auth.followingList}}),{deleteUser:function(){return function(e,t){L.a.delete("/auth/delete",I(t)).then((function(t){e({type:"DELETE_USER",payload:t.data})})).catch((function(t){e(k(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},loadFollowingList:A,unfollow:_})(H),J=n(23),B=n.n(J),Y=(n(85),function(e){return function(t){t({type:"POST_LOADING"}),L.a.get("/posts/id/"+e.toString()).then((function(e){t({type:"GET_POST",payload:e.data})})).catch((function(){t({type:"GET_POST_ERROR"})}))}}),X=function(){return{type:"NO_POST_ID"}},Q=function(e){var t=e().auth.token,n={headers:{"Content-type":"application/json"}};return t&&(n.headers["x-auth-token"]=t),n},z=function(e){var t="";switch(e.type){case"paragraph":return t="<p>"+e.data.text+"</p>",V(t);case"header":return t="<h"+e.data.level+">",t+=e.data.text,t+="</h"+e.data.level+">",V(t);case"simpleImage":var n="",a={};return e.data.withBorder&&(n+="border "),e.data.stretched?n+="w-100 ":a={maxWidth:"650px",margin:"auto",display:"block"},o.a.createElement("div",null,o.a.createElement("img",{src:e.data.url,className:n,style:a,alt:e.data.caption}),o.a.createElement("p",{className:"text-center text-muted"},e.data.caption));case"delimiter":return o.a.createElement("h3",{className:"text-center"},"* * *");case"list":return"ordered"===e.data.style?o.a.createElement("ol",null,e.data.items.map((function(e){return o.a.createElement("li",null,o.a.createElement("p",null,e))}))):o.a.createElement("ul",null,e.data.items.map((function(e){return o.a.createElement("li",null,o.a.createElement("p",null,e))})));default:return o.a.createElement("div",null)}},V=function(e){return o.a.createElement("div",{dangerouslySetInnerHTML:{__html:e}})},$=function(e){return o.a.createElement("div",null,e.blocks.map((function(e,t){return o.a.createElement(z,{key:t,type:e.type,data:e.data})})))},q=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).deletePost=a.deletePost.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.id=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).id,this.id?this.props.getPost(this.id):this.props.noPostId()}},{key:"deletePost",value:function(){this.props.deletePost(this.id)}},{key:"render",value:function(){return this.props.isLoading?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):this.props.deletedPost?o.a.createElement("div",{className:"blog-post"},o.a.createElement("p",{className:"text-center"},"Post deleted")):this.props.foundPost?o.a.createElement("div",{className:"blog-post"},o.a.createElement("div",{className:"text-muted"},o.a.createElement(N.b,{to:"/user/"+this.props.author,className:"text-muted author"},this.props.author)," ",o.a.createElement("p",{style:{display:"inline"},className:"small"},this.props.createdAt.substring(0,10))),o.a.createElement($,{blocks:this.props.content.blocks}),o.a.createElement("br",null),this.props.user&&this.props.user.username===this.props.author?o.a.createElement("div",{className:"row post-btns"},o.a.createElement(N.b,{to:"/edit?id="+this.id,className:"edit-btn btn btn-sm btn-primary btn-block"},"Edit"),o.a.createElement("button",{onClick:this.deletePost,className:"delete-btn btn btn-sm btn-danger btn-block"},"Delete")):null):o.a.createElement("div",{className:"blog-post"},o.a.createElement("p",{className:"text-center"},"Couldn't find post"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry"))}}]),n}(o.a.Component),K=Object(d.b)((function(e){return{title:e.post.title,content:e.post.content,author:e.post.username,createdAt:e.post.createdAt,isLoading:e.post.isLoading,deletedPost:e.post.deletedPost,foundPost:e.post.foundPost,user:e.auth.user}}),{getPost:Y,deletePost:function(e){return function(t,n){e?L.a.delete("/posts/id/"+e.toString(),Q(n)).then((function(e){t({type:"DELETE_POST",payload:e.data})})).catch((function(e){t(k(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})})):window.location="/"}},noPostId:X})(q);n(86);function Z(e){return o.a.createElement("div",null,o.a.createElement("div",{className:"card border-dark"},o.a.createElement("div",{className:"card-body"},o.a.createElement("h2",{className:"card-title"},o.a.createElement(N.b,{to:e.data.postDestination,className:"text-dark stretched-link"},e.data.title)),o.a.createElement("div",{className:"card-subtitle text-muted"},o.a.createElement(N.b,{to:e.data.userDestination,className:"text-muted author"},e.data.author)," ",o.a.createElement("p",{style:{display:"inline"},className:"small date"},e.data.date)))),o.a.createElement("br",null))}var ee=n(31),te=function(e){return function(t){t({type:"LOADING_POSTS"}),L.a.get("/users/"+e+"/posts").then((function(e){var n=Object(ee.a)(e.data);n.sort((function(e,t){return t.createdAt.localeCompare(e.createdAt)})),t({type:"USER_POSTS",payload:{list:n}})})).catch((function(){t({type:"USER_NOT_FOUND"})}))}},ne=function(e){var t=e().auth.token,n={headers:{"Content-type":"application/json"}};return t&&(n.headers["x-auth-token"]=t),n},ae=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){switch(this.props.listType){case"all":this.props.allPosts();break;case"following":this.props.followingPosts();break;case"user":this.props.userPosts(this.props.username);break;default:this.props.allPosts()}}},{key:"render",value:function(){return this.props.isLoading?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):0===this.props.list.length?o.a.createElement("h3",{className:"text-center"},"There's nothing here!"):o.a.createElement("div",null,this.props.list.map((function(e){return o.a.createElement(Z,{key:e._id,data:{title:e.title,author:e.username,date:e.createdAt.substring(0,10),postDestination:"/post?id="+e._id,userDestination:"/user/"+e.username}})})))}}]),n}(o.a.Component),oe=Object(d.b)((function(e){return{isLoading:e.postList.isLoading,list:e.postList.list}}),{allPosts:function(){return function(e){e({type:"LOADING_POSTS"}),L.a.get("/posts/all").then((function(t){var n=Object(ee.a)(t.data);n.sort((function(e,t){return t.createdAt.localeCompare(e.createdAt)})),e({type:"ALL_POSTS",payload:{list:n}})})).catch()}},followingPosts:function(){return function(e,t){e({type:"LOADING_POSTS"}),L.a.get("/posts/following",ne(t)).then((function(t){var n=Object(ee.a)(t.data.posts);n.sort((function(e,t){return t.createdAt.localeCompare(e.createdAt)})),e({type:"FOLLOWING_POSTS",payload:{list:n,noFollowing:t.data.noFollowing}})})).catch((function(t){e(k(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}},userPosts:te})(ae),se=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):o.a.createElement("div",null,o.a.createElement("h1",null,this.props.isAuthenticated?this.props.noFollowing&&!this.props.isLoading?"Discover":"Following":"All Posts"),o.a.createElement("br",null),o.a.createElement(oe,{listType:this.props.isAuthenticated?"following":"all"}))}}]),n}(o.a.Component),re=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(se),le=n(24),ie=n.n(le),ce=n(25),ue=n.n(ce),de=n(26),pe=n.n(de),me=n(27),he=n.n(me),be=n(28),ge=n.n(be),fe=n(29),Ee=n.n(fe),Oe=n(30),ve=n.n(Oe),ye=(n(50),function(){return{type:"POST_TOO_SHORT"}}),we=function(){return{type:"POST_NO_TITLE"}},Se=function(e){var t=e().auth.token,n={headers:{"Content-type":"application/json"}};return t&&(n.headers["x-auth-token"]=t),n},Ne=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={editorIsReady:!1},a.handlePost=a.handlePost.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){var e=this;this.editor=new ie.a({holder:"editorjs",placeholder:"New Post",autofocus:!0,tools:{header:ue.a,simpleImage:pe.a,delimiter:he.a,list:ge.a,underline:Ee.a,inlineCode:ve.a},onReady:function(){e.setState({editorIsReady:!0})},data:{time:0,blocks:[{type:"header",data:{text:"New Post",level:1}}],version:"2.18.0"}})}},{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/login"),this.props.newPostId&&(window.location="/post?id="+this.props.newPostId)}},{key:"handlePost",value:function(){var e=this;this.editor.save().then((function(t){var n=t.blocks;n.length<2?e.props.postTooShort():"header"!==n[0].type||1!==n[0].data.level?e.props.postNoTitle():e.props.postSuccess(t)})).catch((function(e){console.log("Saving failed: "+e)}))}},{key:"render",value:function(){return o.a.createElement("div",null,o.a.createElement("div",{id:"editorjs"}),this.state.editorIsReady?o.a.createElement("div",null,this.props.error?o.a.createElement("div",{className:"alert alert-danger text-center"},this.props.error.msg):null,o.a.createElement("button",{className:"post-button btn btn-lg btn-success btn-block",onClick:this.handlePost},this.props.creatingPost?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Post")):null)}}]),n}(o.a.Component),je=Object(d.b)((function(e){return{error:e.createPost.error,creatingPost:e.createPost.creatingPost,newPostId:e.createPost.newPostId,isAuthenticated:e.auth.isAuthenticated}}),{postSuccess:function(e){return function(t,n){t({type:"CREATING_POST"});var a={title:e.blocks[0].data.text,content:e},o=JSON.stringify(a);L.a.post("/posts/create",o,Se(n)).then((function(e){t({type:"POST_SUCCESS",payload:{newPostId:e.data.post._id}})})).catch((function(){t({type:"CREATE_POST_ERROR"})}))}},postTooShort:ye,postNoTitle:we})(Ne),Pe=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={editorIsReady:!1},a.handlePost=a.handlePost.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.id=B.a.parse(this.props.location.search,{ignoreQueryPrefix:!0}).id,this.id?this.props.getPost(this.id):this.props.noPostId()}},{key:"componentDidUpdate",value:function(){var e=this;!1===this.props.isAuthenticated&&(window.location="/login"),this.props.newPostId&&(window.location="/post?id="+this.props.newPostId),!this.editor&&this.props.foundPost&&(this.editor=new ie.a({holder:"editorjs",placeholder:"Click here to start writing!",tools:{header:ue.a,simpleImage:pe.a,delimiter:he.a,list:ge.a,underline:Ee.a,inlineCode:ve.a},onReady:function(){e.setState({editorIsReady:!0})},data:this.props.content}))}},{key:"handlePost",value:function(){var e=this;this.editor.save().then((function(t){var n=t.blocks;n.length<2?e.props.postTooShort():"header"!==n[0].type||1!==n[0].data.level?e.props.postNoTitle():e.props.title!==n[0].data.text?e.props.diffTitle(e.props.title):e.props.editPost(e.id,t)})).catch((function(e){console.log("Saving failed: "+e)}))}},{key:"render",value:function(){return!1===this.props.foundPost?o.a.createElement("div",null,o.a.createElement("p",{className:"text-center"},"Couldn't find post"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry")):this.props.isAuthenticated&&this.props.author!==this.props.user.username?o.a.createElement("div",{className:"alert alert-danger text-center"},"You are not authorized to edit this post."):o.a.createElement("div",null,o.a.createElement("div",{id:"editorjs"}),this.state.editorIsReady?o.a.createElement("div",null,this.props.error?o.a.createElement("div",{className:"alert alert-danger text-center"},this.props.error.msg):null,o.a.createElement("button",{className:"post-button btn btn-lg btn-success btn-block",onClick:this.handlePost},this.props.creatingPost?o.a.createElement("span",{className:"spinner-border spinner-border-sm"}):"Save")):null)}}]),n}(o.a.Component),Le=Object(d.b)((function(e){return{error:e.createPost.error,creatingPost:e.createPost.creatingPost,newPostId:e.createPost.newPostId,isAuthenticated:e.auth.isAuthenticated,user:e.auth.user,title:e.post.title,content:e.post.content,author:e.post.username,foundPost:e.post.foundPost}}),{editPost:function(e,t){return function(n,a){n({type:"CREATING_POST"});var o={content:t},s=JSON.stringify(o);L.a.patch("/posts/id/"+e,s,Se(a)).then((function(){n({type:"EDIT_POST",payload:{newPostId:e}})})).catch((function(){n({type:"CREATE_POST_ERROR"})}))}},postTooShort:ye,postNoTitle:we,diffTitle:function(e){return{type:"DIFF_TITLE",payload:{oldTitle:e}}},getPost:Y,noPostId:X})(Pe),ke=(n(94),function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(e){var a;return Object(l.a)(this,n),(a=t.call(this,e)).state={isFollowing:null},a.toggleFollow=a.toggleFollow.bind(Object(U.a)(a)),a}return Object(i.a)(n,[{key:"componentDidMount",value:function(){this.props.loadFollowingList()}},{key:"componentDidUpdate",value:function(){var e=this;if(this.props.followingList&&null===this.state.isFollowing){var t=null;this.props.followingList.forEach((function(n,a){n===e.props.match.params.username&&(t=!0,e.setState({isFollowing:!0}))})),null===t&&this.setState({isFollowing:!1})}}},{key:"toggleFollow",value:function(){this.state.isFollowing?this.props.unfollow(this.props.match.params.username):this.props.follow(this.props.match.params.username),this.setState((function(e){return{isFollowing:!e.isFollowing}}))}},{key:"render",value:function(){return null===this.props.userNotFound?(this.props.userPosts(this.props.match.params.username),o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"}))):this.props.userNotFound?o.a.createElement("div",null,o.a.createElement("p",{className:"text-center"},"Couldn't find user"),o.a.createElement("button",{className:"retry-btn btn btn-sm btn-secondary btn-block",onClick:function(){return window.location.reload(!0)}},"Retry")):o.a.createElement("div",null,o.a.createElement("div",{className:"row"},o.a.createElement("h1",{className:"col col-md-auto"},this.props.match.params.username),null!==this.state.isFollowing&&this.props.self&&this.props.self.username!==this.props.match.params.username?this.state.isFollowing?o.a.createElement("button",{className:"follow-btn col btn btn-sm btn-secondary btn-block",onClick:this.toggleFollow},"Unfollow"):o.a.createElement("button",{className:"follow-btn col btn btn-sm btn-primary btn-block",onClick:this.toggleFollow},"Follow"):null),o.a.createElement("br",null),o.a.createElement(oe,{listType:"user",username:this.props.match.params.username}))}}]),n}(o.a.Component)),Te=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,userNotFound:e.postList.userNotFound,followingList:e.auth.followingList,self:e.auth.user}}),{loadFollowingList:A,userPosts:te,follow:function(e){return function(t,n){var a=JSON.stringify({user:e});L.a.patch("/auth/follow",a,I(n)).then((function(e){t({type:"FOLLOW",payload:{newFollowing:e.data.following}})})).catch((function(e){t(k(e.response.data,e.response.status)),t({type:"AUTH_ERROR"})}))}},unfollow:_})(ke),Ae=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/")}},{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):o.a.createElement("div",null,o.a.createElement("h1",null,"All Posts"),o.a.createElement("br",null),o.a.createElement(oe,{listType:"all"}))}}]),n}(o.a.Component),_e=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(Ae),Ie=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidUpdate",value:function(){!1===this.props.isAuthenticated&&(window.location="/login")}},{key:"render",value:function(){return null===this.props.isAuthenticated?o.a.createElement("div",{className:"text-center"},o.a.createElement("div",{className:"spinner-border"})):this.props.noFollowing?o.a.createElement("div",null,o.a.createElement("h1",null,"Following"),o.a.createElement("h3",{className:"text-center"},"There's nothing here!")):o.a.createElement("div",null,o.a.createElement("h1",null,"Following"),o.a.createElement("br",null),o.a.createElement(oe,{listType:"following"}))}}]),n}(o.a.Component),Re=Object(d.b)((function(e){return{isAuthenticated:e.auth.isAuthenticated,noFollowing:e.postList.noFollowing,isLoading:e.postList.isLoading}}))(Ie),Ce=function(e){Object(c.a)(n,e);var t=Object(u.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"componentDidMount",value:function(){S.dispatch((function(e,t){e({type:"USER_LOADING"}),L.a.get("/auth/user",I(t)).then((function(t){return e({type:"USER_LOADED",payload:t.data})})).catch((function(t){e(k(t.response.data,t.response.status)),e({type:"AUTH_ERROR"})}))}))}},{key:"render",value:function(){return o.a.createElement(d.a,{store:S},o.a.createElement(N.a,null,o.a.createElement("div",null,o.a.createElement(C,null),o.a.createElement("br",null),o.a.createElement("div",{className:"container-fluid"},o.a.createElement(j.a,{path:"/",component:re,exact:!0}),o.a.createElement(j.a,{path:"/all",component:_e}),o.a.createElement(j.a,{path:"/following",component:Re}),o.a.createElement(j.a,{path:"/signup",component:x}),o.a.createElement(j.a,{path:"/login",component:W}),o.a.createElement(j.a,{path:"/settings",component:M}),o.a.createElement(j.a,{path:"/post",component:K}),o.a.createElement(j.a,{path:"/create",component:je}),o.a.createElement(j.a,{path:"/edit",component:Le}),o.a.createElement(j.a,{path:"/user/:username",component:Te})))))}}]),n}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));L.a.defaults.baseURL="http://localhost:5000/api",r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Ce,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[53,1,2]]]);
//# sourceMappingURL=main.53dde7c3.chunk.js.map